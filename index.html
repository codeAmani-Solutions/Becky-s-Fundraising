<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Becky's Support Group Fundraising</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Style for loading spinner */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto px-4 py-8 md:py-12 max-w-5xl">

        <!-- Header -->
        <header class="text-center mb-8 md:mb-12">
            <h1 class="text-3xl md:text-4xl font-bold text-pink-600">Becky's Support Group</h1>
            <p class="mt-2 text-md text-gray-600">ðŸ’• Happy Tuesday Dear One's ðŸ’•</p>
        </header>

        <!-- Total Summary Card -->
        <div class="bg-indigo-600 text-white rounded-xl shadow-lg p-6 sm:p-8 mb-10 text-center">
            <h2 class="text-lg font-medium text-indigo-200">Total Contributions Received</h2>
            <p id="totalAmount" class="text-4xl sm:text-5xl font-bold tracking-tight mt-2">$0.00</p>
        </div>
        
        <!-- Search Input -->
        <div class="mb-10">
            <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                    </svg>
                </div>
                <input type="text" id="searchInput" class="block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="Search for a contributor...">
            </div>
        </div>

        <!-- Update, Contribution, and Zoom sections -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-10">
            <!-- Tremendous Update Card -->
            <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-pink-500">
                <h2 class="text-xl font-bold text-gray-800 flex items-center mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-pink-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                    </svg>
                    A Tremendous Update!
                </h2>
                <div class="space-y-4 text-gray-600">
                    <p class="font-semibold">A tremendous update! What a God what a God!</p>
                    <p>Many thanks for the tremendous support you have continued to show sis <strong>Becky & family</strong> during recovery. It's amazing how unified prayers have moved mountains. <span class="text-pink-600 font-semibold">She is healing gently at home! Glory to God.</span></p>
                    <p>Becky had doctor's follow-up appointments since discharge. Her road to recovery per the medical doctors is estimated to take <strong>over 6 months</strong> due to traumatic brain injury. Let us continue uplifting the entire family in prayers as they navigate this recovery journey.</p>
                    <p>Just a friendly reminder the group will be closing this <strong>weekend of October 11th</strong>.</p>
                </div>
            </div>

            <!-- Contribution & Zoom Info -->
            <div class="space-y-8">
                <!-- Contribution Channels Card -->
                <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-yellow-500">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Contribution Channels</h2>
                    <p class="text-gray-600 mb-4">Husband: Samson Wagacha</p>
                    <ul class="space-y-3">
                        <li class="flex flex-wrap justify-between items-center bg-yellow-50 p-3 rounded-md">
                            <span class="font-semibold">Cash App:</span>
                            <span class="font-mono text-pink-600 font-bold">$Samwagacha</span>
                        </li>
                        <li class="flex flex-wrap justify-between items-center bg-yellow-50 p-3 rounded-md">
                            <span class="font-semibold">Zelle:</span>
                            <span class="font-mono text-pink-600 font-bold">(815) 280-8479</span>
                        </li>
                    </ul>
                </div>
                <!-- Prayer & Thanksgiving Zoom Card -->
                <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-pink-500">
                     <h2 class="text-xl font-bold text-gray-800 mb-4">Prayer & Thanksgiving Zoom</h2>
                     <p class="text-gray-600 mb-4">Becky's family would like to thank everyone on this day.</p>
                     <ul class="space-y-3 text-gray-700">
                        <li class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-pink-500 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg><strong>Date:</strong><span class="ml-2">Today, Tuesday (October 7, 2025)</span></li>
                        <li class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-pink-500 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg><strong>Time:</strong><span class="ml-2">8:00 PM</span></li>
                        <li class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-pink-500 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg><strong>Zoom Link:</strong><span class="ml-2">To be shared shortly (/alternatively check the WhatsApp group for link).</span></li>
                     </ul>
                </div>
            </div>
        </div>

        <!-- Contributions Grid -->
        <!-- This container will be filled dynamically by JavaScript -->
        <div id="contributionsGrid" class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Loading spinner will be shown here -->
        </div>

        <!-- No Results Message -->
        <div id="noResults" class="text-center py-10 px-4" style="display: none;">
            <h3 class="text-lg font-semibold text-gray-700">No contributors found</h3>
            <p class="text-gray-500 mt-1">Try searching for a different name.</p>
        </div>

        <!-- Footer -->
        <footer class="text-center mt-12">
            <p class="text-sm text-gray-500">Page generated on October 7, 2025.</p>
        </footer>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            const contributionsGrid = document.getElementById('contributionsGrid');
            const totalAmountEl = document.getElementById('totalAmount');
            const searchInput = document.getElementById('searchInput');

            // --- Data Source from GitHub ---
            const GITHUB_CSV_URL = 'https://raw.githubusercontent.com/codeAmani-Solutions/Becky-s-Fundraising/refs/heads/main/Contributions_List_With_Total.csv';

            async function loadContributions() {
                showLoadingSpinner();
                try {
                    const response = await fetch(GITHUB_CSV_URL);
                    if (!response.ok) {
                        throw new Error(`Network response was not ok: ${response.statusText}`);
                    }
                    const csvData = await response.text();
                    const contributions = parseCsv(csvData);
                    renderData(contributions);

                } catch (error) {
                    contributionsGrid.innerHTML = `<p class="text-red-500 text-center col-span-2">Failed to load contributions: ${error.message}</p>`;
                }
            }

            function showLoadingSpinner() {
                contributionsGrid.innerHTML = '<div class="loader col-span-2"></div>';
            }

            function parseCsv(csvText) {
                const lines = csvText.trim().split('\n');
                const data = [];
                // Start from 1 to skip the header row
                for (let i = 1; i < lines.length; i++) {
                    const line = lines[i].trim();
                    if (!line) continue;

                    const firstCommaIndex = line.indexOf(',');
                    if (firstCommaIndex === -1) continue;

                    const lastCommaIndex = line.lastIndexOf(',');
                    if (lastCommaIndex === -1 || lastCommaIndex === firstCommaIndex) continue;

                    let name = line.substring(firstCommaIndex + 1, lastCommaIndex).trim();
                    let amountStr = line.substring(lastCommaIndex + 1).trim();

                    // Clean up name (remove surrounding quotes)
                    if (name.startsWith('"') && name.endsWith('"')) {
                        name = name.slice(1, -1);
                    }

                    // Clean up amount (remove quotes, $, and commas)
                    amountStr = amountStr.replace(/["$,]/g, '');
                    
                    const amount = parseFloat(amountStr);

                    if (name && !isNaN(amount)) {
                        data.push({ name, amount });
                    }
                }
                // This is a special case from your data that needs to be manually added for now
                data.push({ name: "Mathew & Doreen (Received Ksh. 5000.00)", amount: 38.97 });
                return data;
            }

            function renderData(contributions) {
                contributionsGrid.innerHTML = '';

                const total = contributions.reduce((sum, item) => sum + item.amount, 0);
                totalAmountEl.textContent = `$${total.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;

                const groupSize = 10;
                for (let i = 0; i < contributions.length; i += groupSize) {
                    const group = contributions.slice(i, i + groupSize);
                    const groupStart = i + 1;
                    const groupEnd = i + group.length;
                    
                    const groupTotal = group.reduce((sum, item) => sum + item.amount, 0);

                    const groupEl = document.createElement('div');
                    groupEl.className = 'contribution-group bg-white p-6 rounded-lg shadow-md border border-gray-200';
                    
                    let listItemsHtml = '';
                    group.forEach(item => {
                        const nameHtml = item.name.replace(/\((.*?)\)/g, '<em class="text-xs text-gray-500 ml-1">($1)</em>');
                        listItemsHtml += `
                            <li class="flex justify-between items-center">
                                <span class="contributor-name text-gray-600">${nameHtml}</span>
                                <span class="contributor-amount font-mono font-semibold text-green-700">$${item.amount.toFixed(2)}</span>
                            </li>
                        `;
                    });

                    groupEl.innerHTML = `
                        <h2 class="text-lg font-semibold text-gray-700 border-b pb-3 mb-4">
                            Contributions ${groupStart}-${groupEnd}: 
                            <span class="font-bold text-indigo-600">$${groupTotal.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </h2>
                        <ul class="space-y-3">${listItemsHtml}</ul>
                    `;
                    contributionsGrid.appendChild(groupEl);
                }
            }

            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const contributionGroups = document.querySelectorAll('.contribution-group');
                let totalResults = 0;

                contributionGroups.forEach(group => {
                    const contributors = group.querySelectorAll('li');
                    let groupHasVisibleResult = false;

                    contributors.forEach(contributor => {
                        const name = contributor.querySelector('.contributor-name').textContent.toLowerCase();
                        if (name.includes(searchTerm)) {
                            contributor.style.display = 'flex';
                            groupHasVisibleResult = true;
                            totalResults++;
                        } else {
                            contributor.style.display = 'none';
                        }
                    });

                    if (groupHasVisibleResult) {
                        group.style.display = 'block';
                    } else {
                        group.style.display = 'none';
                    }
                });

                const noResultsMessage = document.getElementById('noResults');
                if (totalResults === 0 && searchTerm !== '') {
                    noResultsMessage.style.display = 'block';
                    contributionsGrid.style.display = 'none';
                } else {
                    noResultsMessage.style.display = 'none';
                    contributionsGrid.style.display = 'grid';
                }
            });

            loadContributions();
        });
    </script>

</body>
</html>

