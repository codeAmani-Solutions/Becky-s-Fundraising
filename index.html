<!DOCTYPE html> 
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Becky's Support Group Fundraising</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Style for loading spinner */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto px-4 py-8 md:py-12 max-w-5xl">

        <!-- Header -->
        <header class="text-center mb-8 md:mb-12">
            <h1 class="text-3xl md:text-4xl font-bold text-pink-600">Becky's Support Group</h1>
            <p class="mt-2 text-md text-gray-600">ðŸ’• Happy Tuesday Dear One's ðŸ’•</p>
        </header>
        
        <!-- Fallback Data Warning -->
        <div id="fallbackWarning" class="hidden bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-8 rounded-md" role="alert">
          <p class="font-bold">Displaying Backup Data</p>
          <p>Could not fetch the live contribution list from GitHub. Displaying a locally stored version. The list may not be fully up-to-date.</p>
        </div>

        <!-- Total Summary Card -->
        <div class="bg-indigo-600 text-white rounded-xl shadow-lg p-6 sm:p-8 mb-10 text-center">
            <h2 class="text-lg font-medium text-indigo-200">Total Contributions Received</h2>
            <p id="totalAmount" class="text-4xl sm:text-5xl font-bold tracking-tight mt-2">$0.00</p>
        </div>
        
        <!-- Search Input -->
        <div class="mb-10">
            <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                    </svg>
                </div>
                <input type="text" id="searchInput" class="block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="Search for a contributor...">
            </div>
        </div>

        <!-- Update, Contribution, and Zoom sections -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-10">
            <!-- Tremendous Update Card -->
            <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-pink-500">
                <h2 class="text-xl font-bold text-gray-800 flex items-center mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-pink-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                    </svg>
                    A Tremendous Update!
                </h2>
                <div class="space-y-4 text-gray-600">
                    <p class="font-semibold">A tremendous update! What a God what a God!</p>
                    <p>Many thanks for the tremendous support you have continued to show sis <strong>Becky & family</strong> during recovery. It's amazing how unified prayers have moved mountains. <span class="text-pink-600 font-semibold">She is healing gently at home! Glory to God.</span></p>
                    <p>Becky had doctor's follow-up appointments since discharge. Her road to recovery per the medical doctors is estimated to take <strong>over 6 months</strong> due to traumatic brain injury. Let us continue uplifting the entire family in prayers as they navigate this recovery journey.</p>
                    <p>Just a friendly reminder the group will be closing this <strong>weekend of October 11th</strong>.</p>
                </div>
            </div>

            <!-- Contribution & Zoom Info -->
            <div class="space-y-8">
                <!-- Contribution Channels Card -->
                <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-yellow-500">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Contribution Channels</h2>
                    <p class="text-gray-600 mb-4">Husband: Samson Wagacha</p>
                    <ul class="space-y-3">
                        <li class="flex flex-wrap justify-between items-center bg-yellow-50 p-3 rounded-md">
                            <span class="font-semibold">Cash App:</span>
                            <span class="font-mono text-pink-600 font-bold">$Samwagacha</span>
                        </li>
                        <li class="flex flex-wrap justify-between items-center bg-yellow-50 p-3 rounded-md">
                            <span class="font-semibold">Zelle:</span>
                            <span class="font-mono text-pink-600 font-bold">(815) 280-8479</span>
                        </li>
                    </ul>
                </div>
                <!-- Prayer & Thanksgiving Zoom Card -->
                <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-pink-500">
                     <h2 class="text-xl font-bold text-gray-800 mb-4">Prayer & Thanksgiving Zoom</h2>
                     <p class="text-gray-600 mb-4">Becky's family would like to thank everyone on this day.</p>
                     <ul class="space-y-3 text-gray-700">
                        <li class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-pink-500 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg><strong>Date:</strong><span class="ml-2">Today, Tuesday (October 7, 2025)</span></li>
                        <li class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-pink-500 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg><strong>Time:</strong><span class="ml-2">8:00 PM</span></li>
                        <li class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-pink-500 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg><strong>Zoom Link:</strong><span class="ml-2">To be shared shortly (/alternatively check the WhatsApp group for link).</span></li>
                     </ul>
                </div>
            </div>
        </div>

        <!-- Contributions Grid -->
        <!-- This container will be filled dynamically by JavaScript -->
        <div id="contributionsGrid" class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Loading spinner will be shown here -->
        </div>

        <!-- No Results Message -->
        <div id="noResults" class="text-center py-10 px-4" style="display: none;">
            <h3 class="text-lg font-semibold text-gray-700">No contributors found</h3>
            <p class="text-gray-500 mt-1">Try searching for a different name.</p>
        </div>

        <!-- Footer -->
        <footer class="text-center mt-12">
            <p class="text-sm text-gray-500">Page generated on October 7, 2025.</p>
        </footer>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            const contributionsGrid = document.getElementById('contributionsGrid');
            const totalAmountEl = document.getElementById('totalAmount');
            const searchInput = document.getElementById('searchInput');
            const fallbackWarning = document.getElementById('fallbackWarning');

            // --- Data Source from GitHub ---
            const GITHUB_CSV_URL = 'https://raw.githubusercontent.com/codeAmani-Solutions/Becky-s-Fundraising/refs/heads/main/Contributions_List_with_Total.csv';

            // --- Fallback data in case GitHub fetch fails ---
            const fallbackCsvData = `
#,Name,Amount (USD)
1,"Queens Beckys Florida Chama group","$2,000.00"
2,Neema & Jeff,$100.00
3,Lydia Mwangi,$100.00
4,David Ngige,$200.00
5,Njira Njeri (Martha),$100.00
6,Isaiah Wachira,$500.00
7,Jeff Mburu,$100.00
8,Evinn,$75.00
9,Sam Ngaruiya,$100.00
10,Festus Nyasimi,$50.00
11,Lynette Kamiti,$50.00
12,Ann Mbuthia,$100.00
13,Elizabeth Milandi,$100.00
14,Peter Karugu,$100.00
15,Naftali Mwaniki,$200.00
16,Anne Kimani,$100.00
17,Jane Hoblock,$100.00
18,Bishop Pau & Pst Ann,$100.00
19,Thuku & Darma,$200.00
20,Terrence & Marion,$100.00
21,Nova & Pam,$200.00
22,Wilson & Susan,$100.00
23,Simon & Sarah,$700.00
24,Nobs & Kate,$200.00
25,Irene Wachira,$100.00
26,Tina Tamoi,$200.00
27,"Godfrey & Emily Gitogo","$2,800.00"
28,Jack & Njeri Chege,$200.00
29,Petronilla David,$100.00
30,John and Lilian Kishe,$150.00
31,Joe & Kezia,$500.00
32,Morris & Rebecca W,$250.00
33,David Mbaire,$150.00
34,Joseph Gekara,$100.00
35,Mukulu,$100.00
36,Njenga wa Mukami,$100.00
37,Tosh & Agnes Kimathi,$100.00
38,Gerald & Shiku,$250.00
39,Mr & Mrs Blake,$100.00
40,Lilian & Jeff,$100.00
41,Dicky & Maggie K,$100.00
42,Muthoni Otwoma,$50.00
43,Mary Kym,$150.00
44,John & Grace Muhia,$200.00
45,Sailas & Grace,$300.00
46,Kanyi & Gladys,$300.00
47,David & Ann Kimani,$100.00
48,"Imaq, Josh, Jonah, Josh, & Nella",$500.00
49,Susan & Warren,$400.00
50,Liz Mugo,$100.00
51,Eddie & Judy,$100.00
52,Joel & Curry,$100.00
53,Mr & Mrs Eric Maina,$200.00
54,Mr & Mrs Peterson Mwangi,$200.00
55,Rose Wambugu,$100.00
56,Ed Mwangi,$100.00
57,Frank Njoroge & Rachel M,$200.00
58,Marystella Waffubwa,$50.00
59,James & Salome,$200.00
60,Bsp John & Pst Cathy K,$100.00
61,Edna Kimanzi,$100.00
62,Pst Dennis & Betty Tesot,$100.00
63,Harry & Penny,$100.00
64,Elizabeth Wanjiru,$100.00
65,Caroline Thiongo,$100.00
66,Grace Maungu,$100.00
67,Endita & Ian,$100.00
68,Rubi Muturi,$100.00
69,John Muchabi,$150.00
70,Isaac Ngigi,$300.00
71,Fred Muhanji,$150.00
72,Samuel Kimiti,$150.00
73,Stephen Masha,$100.00
74,Edwin Oroko,$100.00
75,Daniel Kirwa,$100.00
76,Lincoln Wagacha,$200.00
77,Austin & Emma,$150.00
78,Peter Oduori,$100.00
79,Benard Ndege,$100.00
80,David Kimani,$100.00
81,Timothy Sirkoi,$100.00
82,Douglas,$100.00
83,Bob Mwiti,$100.00
84,Wilson Njenga,$100.00
85,Anthony Kimani,$100.00
86,Jeremy Kemboi,$100.00
87,Joyce Gachanja,$70.00
88,Susan & Terry Ductan,$100.00
89,Abija Muembu,$100.00
90,Jane Lydia,$100.00
91,Caroline Lugalia,$50.00
92,Sam & Tabitha,$100.00
93,Sam & Rahab,$100.00
94,Loise & Ron,$100.00
95,Beatrice Kamau,$50.00
96,James & Ann Kimani,$200.00
97,Eliza & Kimani,$100.00
98,Veronica Williams,$100.00
99,Mueni & Ambrose,$100.00
100,Laura Wright,$100.00
101,Mr & Mrs Gatete,$200.00
102,Bella Kaburu,$250.00
103,Margret Kuria,$100.00
104,Damaris Mbugua,$100.00
105,Lucy Waweru,$100.00
106,"James, Emily & Family",$200.00
107,Phloice Odawa,$100.00
108,Caroline Karanja,$100.00
109,Jeniffer Mulili,$100.00
110,David & Fatuma Towett,$250.00
111,Kamau & Angelica,$200.00
`;

            async function loadContributions() {
                showLoadingSpinner();
                try {
                    // Try to fetch live data
                    const response = await fetch(GITHUB_CSV_URL);
                    if (!response.ok) {
                        throw new Error(`Network response was not ok: ${response.statusText}`);
                    }
                    const csvData = await response.text();
                    const contributions = parseCsv(csvData);
                    renderData(contributions);
                } catch (error) {
                    // If fetching fails, use the fallback data
                    console.warn("Could not fetch from GitHub, using fallback data. Error:", error);
                    fallbackWarning.classList.remove('hidden');
                    const contributions = parseCsv(fallbackCsvData);
                    renderData(contributions);
                }
            }

            function showLoadingSpinner() {
                contributionsGrid.innerHTML = '<div class="loader col-span-2"></div>';
            }

            function parseCsv(csvText) {
                const lines = csvText.trim().split('\n');
                const data = [];
                for (let i = 1; i < lines.length; i++) { // Start at 1 to skip header
                    const line = lines[i].trim();
                    if (!line) continue;
                    
                    const matches = line.match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g);
                    if (!matches || matches.length < 3) continue;

                    let name = matches[1].trim();
                    if (name.startsWith('"') && name.endsWith('"')) {
                        name = name.slice(1, -1);
                    }
                    
                    let amountStr = matches[2].trim().replace(/["$,]/g, '');
                    const amount = parseFloat(amountStr);

                    if (name && !isNaN(amount)) {
                        data.push({ name, amount });
                    }
                }
                if (!csvText.includes("Mathew & Doreen")) {
                     data.push({ name: "Mathew & Doreen (Received Ksh. 5000.00)", amount: 38.97 });
                }
                return data;
            }

            function renderData(contributions) {
                contributionsGrid.innerHTML = '';
                const total = contributions.reduce((sum, item) => sum + item.amount, 0);
                totalAmountEl.textContent = `$${total.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;

                const groupSize = 10;
                for (let i = 0; i < contributions.length; i += groupSize) {
                    const group = contributions.slice(i, i + groupSize);
                    const groupStart = i + 1;
                    const groupEnd = i + group.length;
                    const groupTotal = group.reduce((sum, item) => sum + item.amount, 0);
                    const groupEl = document.createElement('div');
                    groupEl.className = 'contribution-group bg-white p-6 rounded-lg shadow-md border border-gray-200';
                    let listItemsHtml = '';
                    group.forEach(item => {
                        const nameHtml = item.name.replace(/\((.*?)\)/g, '<em class="text-xs text-gray-500 ml-1">($1)</em>');
                        listItemsHtml += `
                            <li class="flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0">
                                <span class="contributor-name text-gray-600">${nameHtml}</span>
                                <span class="contributor-amount font-mono font-semibold text-green-700">$${item.amount.toFixed(2)}</span>
                            </li>`;
                    });
                    groupEl.innerHTML = `
                        <h2 class="text-lg font-semibold text-gray-700 border-b pb-3 mb-3">
                            Contributions ${groupStart}-${groupEnd}: 
                            <span class="font-bold text-indigo-600">$${groupTotal.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </h2>
                        <ul class="space-y-1">${listItemsHtml}</ul>`;
                    contributionsGrid.appendChild(groupEl);
                }
            }

            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const contributionGroups = document.querySelectorAll('.contribution-group');
                let totalResults = 0;
                contributionGroups.forEach(group => {
                    const contributors = group.querySelectorAll('li');
                    let groupHasVisibleResult = false;
                    contributors.forEach(contributor => {
                        const name = contributor.querySelector('.contributor-name').textContent.toLowerCase();
                        if (name.includes(searchTerm)) {
                            contributor.style.display = 'flex';
                            groupHasVisibleResult = true;
                            totalResults++;
                        } else {
                            contributor.style.display = 'none';
                        }
                    });
                    group.style.display = groupHasVisibleResult ? 'block' : 'none';
                });
                const noResultsMessage = document.getElementById('noResults');
                noResultsMessage.style.display = totalResults === 0 && searchTerm !== '' ? 'block' : 'none';
                contributionsGrid.style.display = totalResults === 0 && searchTerm !== '' ? 'none' : 'grid';
            });

            loadContributions();
        });
    </script>

</body>
</html>

